<div class="container-fluid">
	<div class="row">
		<div class="col-lg-12">
			<h1 class="page-header" lang="en" data-lang-token="main_menu_general_conf_token">General</h1>
			<div class="introd">
				<h4 lang="en" data-lang-token="remote_general_conf_intro">You can edit the general configuration here.</h4>
			</div>
			<hr>
			<div class="col-lg-12">
				<form id="generalConfForm"></form>
				<div id='editor_holder'></div>
				<button id='submit'>Submit (console.log)</button>
			</div>
		</div>
	</div>
</div>


<script>
	function removeAdvanced(obj,searchStack)
	{
		searchStack = [];
		$.each(obj, function(key, val) {
			if ( typeof(val) == 'object' )
			{
				searchStack.push(key);
				if (! removeAdvanced(val,searchStack) )
					searchStack.pop();
			}
			else if ( key == "advanced" && val == true )
			{
				console.log(searchStack);
				return true;
			}
		});
		return false;
	}

	$(hyperion).on("cmd-config-getschema", function(event) {
		parsedConfSchemaJSON = event.response.result;

		// remove all "advanced" options from schema
		//removeAdvanced(parsedConfSchemaJSON, []); // not working atm
		//console.log(JSON.stringify(parsedConfSchemaJSON));
		schema = parsedConfSchemaJSON.properties;

		var element = document.getElementById('editor_holder');
		//JSONEditor.defaults.options.theme = 'bootstrap3';
		var general_conf_editor = new JSONEditor(element,{
			theme: 'bootstrap3',
			disable_collapse: 'true',
			form_name_root: 'sa',
			disable_edit_json: 'true',
			disable_properties: 'true',
			no_additional_properties: 'true',
			schema: {
				title:' ',
				properties: {
					schema.blackborderdetector,
					schema.color,
					schema.device,
					schema.effects,
					schema.forwarder,
					schema.framegrabber,
					//schema.grabber-v4l2,
					schema.initialEffect,
					schema.kodiVideoChecker,
					schema.smoothing,
					schema.logger,
					schema.jsonServer,
					schema.protoServer,
					schema.boblightServer,
					schema.udpListener,
					schema.webConfig
				}
			}
		});
	});

	$(document).ready( function() {
		requestServerConfigSchema();

		document.getElementById('submit').addEventListener('click',function() {
			// Get the value from the editor
			console.log(general_conf_editor.getValue());
		});
    //  $("[type='checkbox']").bootstrapSwitch();
	});


</script>
